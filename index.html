<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FreedomNumber — Retirement Corpus Calculator (India)</title>
  <meta name="description" content="An India-focused retirement corpus calculator. Model regular and one-time expenses, safety margin, stress scenarios, and see clear key metrics with a transparent audit." />
  <link rel="stylesheet" href="style.css?v=9" />
  <!-- Keep your current JS include/version -->
  <script defer src="script.js?v=16"></script>
</head>
<body>
  <!-- Header -->
  <header class="nav" role="banner">
    <div class="nav__brand">
      <span class="nav__name">FreedomNumber</span>
    </div>
    <nav class="nav__links" aria-label="Primary">
      <a href="#calc">Calculator</a>
      <a href="#results">Results</a>
      <a href="#method">Method</a>
    </nav>
  </header>

  <main class="wrap">
    <!-- Hero -->
    <section class="hero section">
      <p class="eyebrow">India-focused</p>
      <h1 class="title">Retirement Corpus Calculator</h1>
      <p class="subtitle">
        Estimate your retirement corpus with Indian assumptions. Keep it simple, or add details when you’re ready.
      </p>
      <div class="actions">
        <a class="btn btn--primary" href="#calc">Open Calculator</a>
        <a class="btn btn--link" href="#method">View Methodology</a>
      </div>
    </section>

    <!-- Calculator -->
    <section id="calc" class="section" aria-label="Calculator">
      <div class="card">
        <div class="card__head">
          <h2>Calculator</h2>
          <div class="card__tools">
            <button type="button" class="btn btn--secondary" id="loadIndicative" title="Prefill indicative Indian defaults">Prefill India</button>
            <button type="button" class="btn btn--secondary" id="resetBtn" title="Reset all inputs">Reset</button>
          </div>
        </div>

        <div class="grid cols-3 form-grid">
          <div>
            <label for="currentAge">Current age</label>
            <input id="currentAge" type="number" inputmode="numeric" value="40" />
          </div>
          <div>
            <label for="freedomAge">Target retirement age</label>
            <input id="freedomAge" type="number" inputmode="numeric" value="55" />
          </div>
          <div>
            <label for="lifeAge">Life expectancy</label>
            <input id="lifeAge" type="number" inputmode="numeric" value="85" />
            <span class="help">How long your money needs to last. Quick set:
              <button type="button" class="btn btn--secondary" id="life85">85</button>
              <button type="button" class="btn btn--secondary" id="life90">90</button>
              <button type="button" class="btn btn--secondary" id="life95">95</button>
            </span>
          </div>

          <div>
            <label for="currentCorpus">Current retirement corpus (₹)</label>
            <input id="currentCorpus" type="number" inputmode="decimal" value="2000000" />
            <span class="help">Sum NPS/EPF/PPF, equity/debt funds, gold/bonds <b>saved for retirement</b>. Exclude emergency & other goals.</span>
          </div>
          <div>
            <label for="monthlySIP">Monthly SIP till retirement (₹)</label>
            <input id="monthlySIP" type="number" inputmode="decimal" value="30000" />
            <span class="help">Continues until retirement age.</span>
          </div>
          <div>
            <label for="annualRetirementIncome">Expected yearly income in retirement (₹/yr)</label>
            <input id="annualRetirementIncome" type="number" inputmode="decimal" value="240000" />
            <span class="help">Pension, rent, annuity etc. during retirement. <b>Reduces</b> withdrawals from your corpus.</span>
          </div>

          <div>
            <label for="ret">Expected annual return (after tax &amp; fees)</label>
            <input id="ret" type="number" inputmode="decimal" step="0.001" value="0.08" />
            <span class="help">Use what you expect to keep after taxes & fees. If unsure, 0.06–0.08 (6–8%).</span>
          </div>
          <div>
            <label for="inflation">General inflation (default)</label>
            <input id="inflation" type="number" inputmode="decimal" step="0.001" value="0.06" />
            <span class="help">Used where item-level growth isn’t specified.</span>
          </div>
          <div>
            <label for="buffer">Safety buffer on yearly spend</label>
            <input id="buffer" type="number" inputmode="decimal" step="0.001" value="0.15" />
            <span class="help">Adds a cushion for surprises (medical, repairs). If unsure, keep 0.15 (15%).</span>
          </div>

          <div>
            <label for="ter">Fund expense ratio (optional)</label>
            <input id="ter" type="number" inputmode="decimal" step="0.001" value="0.0000" />
            <span class="help">Only needed if your return above is <i>before</i> fees. Otherwise leave 0.</span>
          </div>
          <div>
            <label><b>Stress test</b></label>
            <div class="actions" style="gap:8px">
              <button type="button" class="btn btn--secondary" id="stressOff" aria-pressed="true">Off</button>
              <button type="button" class="btn btn--secondary" id="stressOn" aria-pressed="false" title="−2% real for first 10 years after retirement">Bear decade</button>
            </div>
            <span class="small">Illustrative −2% real for first 10 years <b>after retirement age</b>.</span>
          </div>
        </div>

        <!-- Regular expenses -->
        <div class="card section" aria-label="Regular expenses">
          <div class="card__head">
            <h3>Regular expenses</h3>
            <button type="button" class="btn btn--secondary" id="addReg">Add item</button>
          </div>
          <p class="small">
            <b>Tip:</b> <u>Start age</u> = when this expense begins. <u>Tenure</u> = years it runs.
            For lifetime items, set Tenure ≈ Life expectancy − Start age.
          </p>
          <div class="table-wrap">
            <table id="regTable">
              <thead>
                <tr>
                  <th scope="col">Category</th>
                  <th class="num" scope="col">Amount today (₹/yr)</th>
                  <th class="num" scope="col">Growth / yr</th>
                  <th class="num" scope="col">Tenure (yrs)</th>
                  <th class="num" scope="col">Start age</th>
                  <th scope="col">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Household &amp; utilities</td>
                  <td class="num">360000</td>
                  <td class="num">0.06</td>
                  <td class="num">45</td>
                  <td class="num">40</td>
                  <td></td>
                </tr>
                <tr>
                  <td>Groceries &amp; essentials</td>
                  <td class="num">240000</td>
                  <td class="num">0.06</td>
                  <td class="num">45</td>
                  <td class="num">40</td>
                  <td></td>
                </tr>
                <tr>
                  <td>Healthcare &amp; insurance</td>
                  <td class="num">150000</td>
                  <td class="num">0.10</td>
                  <td class="num">45</td>
                  <td class="num">40</td>
                  <td></td>
                </tr>
                <tr>
                  <td>Transport</td>
                  <td class="num">120000</td>
                  <td class="num">0.05</td>
                  <td class="num">45</td>
                  <td class="num">40</td>
                  <td></td>
                </tr>
                <tr>
                  <td>Discretionary</td>
                  <td class="num">180000</td>
                  <td class="num">0.07</td>
                  <td class="num">20</td>
                  <td class="num">55</td>
                  <td></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Planned / one-time events -->
        <div class="card section" aria-label="Planned one-time events">
          <div class="card__head">
            <h3>Planned / one-time events</h3>
            <button type="button" class="btn btn--secondary" id="addPlan">Add event</button>
          </div>
          <p class="small">Events at specific ages (education, renovation). Amounts inflate from today by the item’s inflation.</p>
          <div class="table-wrap">
            <table id="planTable">
              <thead>
                <tr>
                  <th scope="col">Event</th>
                  <th class="num" scope="col">Event age</th>
                  <th class="num" scope="col">Amount today (₹)</th>
                  <th class="num" scope="col">Inflation</th>
                  <th scope="col">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Child higher education</td>
                  <td class="num">50</td>
                  <td class="num">1000000</td>
                  <td class="num">0.06</td>
                  <td></td>
                </tr>
                <tr>
                  <td>Home renovation</td>
                  <td class="num">60</td>
                  <td class="num">800000</td>
                  <td class="num">0.05</td>
                  <td></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

      </div>
    </section>

    <!-- Results / KPIs -->
    <section id="results" class="section">
      <div class="card" role="region" aria-label="Key results">
        <div class="card__head">
          <h2>Key metrics</h2>
          <span id="kpiStatus" class="badge badge--neutral">Balanced</span>
        </div>

        <!-- Early depletion warning -->
        <div id="earlyWarning" class="summary-banner" hidden></div>

        <!-- Summary banner -->
        <div id="summaryBanner" class="summary-banner">Enter or adjust the inputs to see your plan.</div>

        <div class="grid cols-3 kpi-grid">
          <div class="kpi">
            <div class="kpi__t">Corpus at retirement</div>
            <div class="kpi__v" id="kpiCorpusFreedom">—</div>
            <div class="kpi__sub">Projected corpus at age <span id="freedomEcho">55</span>.</div>
          </div>
          <div class="kpi">
            <div class="kpi__t">Year-1 retirement spend</div>
            <div class="kpi__v" id="kpiSpendYear1">—</div>
            <div class="kpi__sub">Need in first year (incl. safety margin, less income).</div>
          </div>
          <div class="kpi">
            <div class="kpi__t">Withdrawal rate (Year-1 / corpus)</div>
            <div class="kpi__v" id="kpiSWR">—</div>
            <div class="kpi__sub">Lower is safer: ≤4–5% conservative; 5–6% reasonable; &gt;6% aggressive.</div>
          </div>
        </div>

        <div class="grid cols-3 kpi-grid">
          <div class="kpi" id="kpiSurplusWrap">
            <div class="kpi__t">Surplus / shortfall at age <span id="lifeAgeEcho">85</span></div>
            <div class="kpi__v" id="kpiSurplus">—</div>
            <div class="kpi__sub">Projected amount left (or lacking) at life expectancy.</div>
          </div>
          <div class="kpi">
            <div class="kpi__t">Extra needed today (if any)</div>
            <div class="kpi__v" id="kpiReq">—</div>
            <div class="kpi__sub">Lump sum to add now to avoid shortfall.</div>
          </div>
          <div class="kpi">
            <div class="kpi__t">What this means</div>
            <div class="kpi__v" id="kpiNarrative">—</div>
            <div class="kpi__sub">Plain-English one-liner.</div>
          </div>
        </div>

        <!-- Compare: 40× rule (US) -->
        <details style="margin-top:8px">
          <summary class="small">Compare: 40× rule (US context)</summary>
          <div class="grid cols-3 kpi-grid" style="margin-top:8px">
            <div class="kpi">
              <div class="kpi__t">Annual spend today</div>
              <div class="kpi__v" id="kpiAnnual">—</div>
              <div class="kpi__sub">From your current expense items.</div>
            </div>
            <div class="kpi">
              <div class="kpi__t">Rule-of-thumb corpus (40×)</div>
              <div class="kpi__v" id="kpi40x">—</div>
              <div class="kpi__sub">US-derived proxy; India assumptions differ.</div>
            </div>
          </div>
          <p class="small">The 4%/40× rule was built for US data (lower inflation, ~30-year horizon, pre-tax).
          Your number above uses India-specific, year-by-year modeling with buffers.</p>
        </details>

      </div>
    </section>

    <!-- Projection & tools -->
    <section class="section">
      <div class="card" aria-label="Projection & tools">
        <div class="card__head">
          <h2>Projection & audit</h2>
          <div class="card__tools">
            <button type="button" class="btn btn--secondary" id="auditBtn" title="Show calculation audit">Open audit</button>
            <button type="button" class="btn btn--secondary" id="shareBtn" title="Create a shareable link">Share plan</button>
            <button type="button" class="btn btn--primary" id="exportBtn" title="Export projection as CSV">Export CSV</button>
          </div>
        </div>
        <p class="small">Ending corpus is targeted near ₹0 at age <span id="lifeAgeEcho">85</span>. Click a row to audit that year.</p>

        <div class="table-wrap">
          <table id="projTable" aria-label="Projection table">
            <thead>
              <tr>
                <th scope="col">Age</th>
                <th class="num" scope="col">Regular (₹)</th>
                <th class="num" scope="col">Planned (₹)</th>
                <th class="num" scope="col">Total (₹)</th>
                <th class="num" scope="col">+ Buffer (₹)</th>
                <th class="num" scope="col">Start corpus (₹)</th>
                <th class="num" scope="col">Return (₹)</th>
                <th class="num" scope="col">End corpus (₹)</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Methodology -->
    <section id="method" class="section card" aria-label="Methodology & Assumptions">
      <h2>Methodology & assumptions</h2>
      <p class="small">
        We project cash flows year-by-year with line-item expenses (using each item’s growth), planned events (inflated from today),
        a safety margin on total spend, and your expected net annual return (after tax & fees). We deduct any retirement income and
        carry the corpus forward. Optional stress test: −2% real for first 10 years post-retirement.
      </p>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer" role="contentinfo">
    <div class="wrap footer__inner">
      <div>© FreedomNumber — Model v1.3 · 26 Oct 2025</div>
      <div class="footer__muted">
        Educational tool; not investment advice. Consult a SEBI-registered advisor. No personal data leaves your browser.
      </div>
    </div>
  </footer>

  <!-- Audit Modal -->
  <div class="modal-backdrop" id="auditBackdrop" role="dialog" aria-modal="true" aria-labelledby="auditTitle">
    <div class="modal">
      <div class="modal__head">
        <h3 id="auditTitle">Calculation audit</h3>
        <div class="modal__tools">
          <input id="auditAge" type="number" class="audit__age" aria-label="Audit age" />
          <button type="button" class="btn btn--secondary" id="auditGo">Show</button>
          <button type="button" class="btn btn--secondary" id="auditClose">Close</button>
        </div>
      </div>
      <div id="auditSummary" class="small modal__summary"></div>
      <div class="audit-grid">
        <div class="audit-block">
          <b>Regular expenses</b>
          <div id="auditRegular" class="mono audit__list"></div>
        </div>
        <div class="audit-block">
          <b>Planned expenses</b>
          <div id="auditPlanned" class="mono audit__list"></div>
        </div>
        <div class="audit-block">
          <b>Aggregation</b>
          <div id="auditAgg" class="mono audit__list"></div>
        </div>
        <div class="audit-block">
          <b>Formulas</b>
          <div class="mono small">
            Regular @ age A (start S, tenure T, growth g): if S ≤ A &lt; S+T ⇒ amount × (1+g)^(A − S)<br><br>
            Planned @ event age E (inflation i): amountToday × (1+i)^(E − currentAge)<br><br>
            total = regular + planned<br>
            totalWithBuffer = total × (1 + safetyMargin)<br>
            retirementIncomeOffset = max(0, totalWithBuffer − retirementIncome)<br><br>
            effectiveRate(age) = net return (after tax & fees); stressed: −2% real for first 10 post-retirement years<br>
            return = startCorpus × effectiveRate(age)<br>
            endCorpus = startCorpus + return − retirementIncomeOffset
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
