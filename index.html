<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Retirement Corpus Calculator — India</title>
  <meta name="description" content="A professional, India-focused retirement corpus calculator with transparent methodology, per-year projections, and an audit trail." />
  <link rel="icon" href="assets/favicon.ico">
  <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
  <meta property="og:title" content="Retirement Corpus Calculator — India" />
  <meta property="og:description" content="Build a transparent, India-focused retirement plan with per-item expenses, buffers, and a goal-seeked starting corpus." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://babubl.github.io/FreedomNumber/" />
  <meta property="og:image" content="assets/cover.png" />
  <link rel="stylesheet" href="style.css?v=4" />
  <script defer src="script.js?v=6"></script>
</head>
<body>
  <!-- Top Navigation -->
  <header class="nav" role="banner">
    <div class="nav__brand">
      <span class="nav__name">FreedomNumber</span>
    </div>
    <nav class="nav__links" aria-label="Primary">
      <a href="#method">Methodology</a>
      <a href="#calc">Calculator</a>
      <a href="#results">Results</a>
    </nav>
  </header>

  <main class="wrap">
    <!-- Hero: concise, bank-grade -->
    <section class="hero section" aria-label="Overview">
      <p class="eyebrow">India-focused</p>
      <h1 class="title">Retirement Corpus Calculator</h1>
      <p class="subtitle">
        Plan with Indian inflation, post-tax returns, and real-life milestones. Edit assumptions, review per-year projections,
        export to CSV, and audit every calculation.
      </p>
      <div class="actions">
        <a class="btn btn--primary" href="#calc">Open Calculator</a>
        <a class="btn btn--link" href="#method">View Methodology</a>
      </div>
    </section>

    <!-- Methodology -->
    <section id="method" class="section card" aria-label="Methodology & Assumptions">
      <h2>Methodology & Assumptions</h2>
      <p class="small">
        The U.S. “4% rule” (Bengen, 1994) assumes ~3% inflation, ~50/50 stock–bond mix, ~7–8% nominal returns, and a ~30-year horizon,
        before taxes and fees. Indian households typically face higher inflation, tax drag and longer horizons. This model projects
        cash flows year-by-year with line-item expenses and a safety buffer, then goal-seeks the starting corpus such that ending
        corpus ≈ ₹0 at life expectancy.
      </p>
      <div class="grid cols-3">
        <div>
          <label><b>Modelled</b></label>
          <ul class="small">
            <li>Per-item annual expenses with growth & tenure</li>
            <li>Planned one-time events at specific ages</li>
            <li>Annual buffer on total spend (see policy)</li>
            <li>Post-tax constant return rate, less TER</li>
          </ul>
        </div>
        <div>
          <label><b>India Context</b></label>
          <ul class="small">
            <li>Education & healthcare inflation often &gt; headline CPI</li>
            <li>Tax & fees reduce realised returns (TER haircut applied)</li>
            <li>Longer horizons common; sensitivity to longevity provided</li>
          </ul>
        </div>
        <div>
          <label><b>Policy & Limits</b></label>
          <ul class="small">
            <li><b>Buffer policy:</b> buffer applies on <i>gross spend</i>; retirement income is deducted afterwards</li>
            <li>Sequence risk: optional “Bear Decade” (−2% real for 10 years post-freedom)</li>
            <li>Tax regime toggle is informational for now (no impact yet)</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Calculator -->
    <section id="calc" class="section" aria-label="Calculator">
      <div class="grid cols-2">
        <!-- Inputs -->
        <div class="card">
          <div class="card__head">
            <h2>Inputs</h2>
            <div class="card__tools">
              <button class="btn btn--secondary" id="loadIndicative" title="Prefill indicative Indian defaults">Prefill India</button>
              <button class="btn btn--secondary" id="resetBtn" title="Reset all inputs">Reset</button>
            </div>
          </div>
          <p class="small">Defaults reflect an indicative urban household. Adjust to your context.</p>

          <!-- Core inputs -->
          <div class="grid cols-2 form-grid">
            <div>
              <label for="currentAge">Current Age</label>
              <input id="currentAge" type="number" inputmode="numeric" value="40" />
            </div>
            <div>
              <label for="freedomAge">Target Freedom Age</label>
              <input id="freedomAge" type="number" inputmode="numeric" value="55" />
            </div>
            <div>
              <label for="lifeAge">Life Expectancy</label>
              <input id="lifeAge" type="number" inputmode="numeric" value="85" />
            </div>
            <div>
              <label for="inflation">General Inflation (default)</label>
              <input id="inflation" type="number" inputmode="decimal" step="0.001" value="0.06" />
              <span class="help">0.06 = 6%</span>
            </div>
            <div>
              <label for="ret">Post-tax Return (annual)</label>
              <input id="ret" type="number" inputmode="decimal" step="0.001" value="0.08" />
              <span class="help">0.08 = 8%</span>
            </div>
            <div>
              <label for="buffer">Safety Buffer on Spend</label>
              <input id="buffer" type="number" inputmode="decimal" step="0.001" value="0.15" />
              <span class="help">Applied to gross spend each year</span>
            </div>
          </div>

          <hr style="border:none;border-top:1px solid var(--line);margin:16px 0" />

          <!-- Enhancements: corpus, SIP, income, TER, tax, longevity, stress -->
          <div class="grid cols-2 form-grid">
            <div>
              <label for="currentCorpus">Current Investable Corpus (₹)</label>
              <input id="currentCorpus" type="number" inputmode="decimal" value="2000000" />
              <span class="help">Liquid/investable assets today</span>
            </div>
            <div>
              <label for="monthlySIP">Monthly SIP till Freedom Age (₹)</label>
              <input id="monthlySIP" type="number" inputmode="decimal" value="30000" />
              <span class="help">Continues until freedom age</span>
            </div>
            <div>
              <label for="annualRetirementIncome">Annual Income in Retirement (₹)</label>
              <input id="annualRetirementIncome" type="number" inputmode="decimal" value="240000" />
              <span class="help">Pension, rent, annuity, etc.</span>
            </div>
            <div>
              <label for="ter">Portfolio Expense Ratio (TER)</label>
              <input id="ter" type="number" inputmode="decimal" step="0.001" value="0.0075" />
              <span class="help">0.0075 = 0.75% p.a. haircut to returns</span>
            </div>
          </div>

          <div class="grid cols-3" style="margin-top:8px">
            <div>
              <label><b>Longevity Preset</b></label>
              <div class="actions" style="gap:8px">
                <button class="btn btn--secondary" id="life85">85</button>
                <button class="btn btn--secondary" id="life90">90</button>
                <button class="btn btn--secondary" id="life95">95</button>
              </div>
            </div>
            <div>
              <label for="taxRegime"><b>Tax Regime</b> <span class="small">(no impact yet)</span></label>
              <div class="actions" style="gap:8px">
                <button class="btn btn--secondary" id="taxOld" aria-disabled="true" title="Informational toggle; no impact yet">Old</button>
                <button class="btn btn--secondary" id="taxNew" aria-disabled="true" title="Informational toggle; no impact yet">New</button>
              </div>
            </div>
            <div>
              <label><b>Stress Test</b></label>
              <div class="actions" style="gap:8px">
                <button class="btn btn--secondary" id="stressOff">Off</button>
                <button class="btn btn--secondary" id="stressOn" title="−2% real for first 10 years after freedom age">Bear Decade</button>
              </div>
              <span class="small">Illustrative −2% real in first 10 years <b>after freedom age</b></span>
            </div>
          </div>
        </div>

        <!-- Key Metrics -->
        <div class="card" id="kpiLive" role="status" aria-live="polite">
          <h2>Key Metrics</h2>
          <div class="grid cols-3 kpi-grid">
            <div class="kpi">
              <div class="kpi__t">Annual Spend Today (Active)</div>
              <div class="kpi__v" id="kpiAnnual">—</div>
            </div>
            <div class="kpi">
              <div class="kpi__t">Rule-of-Thumb (40×)</div>
              <div class="kpi__v" id="kpi40x">—</div>
            </div>
            <div class="kpi">
              <div class="kpi__t">Additional Lump Sum Needed (Today)</div>
              <div class="kpi__v" id="kpiReq">—</div>
            </div>
          </div>
          <div class="grid cols-3 kpi-grid">
            <div class="kpi">
              <div class="kpi__t">Max Corpus During Plan</div>
              <div class="kpi__v" id="kpiMax">—</div>
            </div>
            <div class="kpi">
              <div class="kpi__t">Implied SWR in Year-1*</div>
              <div class="kpi__v" id="kpiSWR">—</div>
            </div>
            <div class="kpi" id="kpiSurplusWrap">
              <div class="kpi__t">Surplus / Shortfall at Life Expectancy</div>
              <div class="kpi__v" id="kpiSurplus">—</div>
            </div>
          </div>
          <p class="small">*At Freedom Age: (Spend + Buffer) ÷ Starting Corpus for that year.</p>
        </div>
      </div>

      <!-- Expense Tables -->
      <div class="section">
        <div class="card" aria-label="Regular Expenses">
          <div class="card__head">
            <h2>Regular Expenses</h2>
            <button class="btn btn--secondary" id="addReg">Add Item</button>
          </div>
          <p class="small">Annual amounts in today’s ₹. Each item can grow at its own rate and end after a set tenure.</p>
          <div class="table-wrap">
            <table id="regTable">
              <thead>
                <tr>
                  <th scope="col">Category</th>
                  <th class="num" scope="col">Amount Today (₹/yr)</th>
                  <th class="num" scope="col">Growth / yr</th>
                  <th class="num" scope="col">Tenure (yrs)</th>
                  <th class="num" scope="col">Start Age</th>
                  <th scope="col">Action</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div class="card" aria-label="Planned / One-time Expenses">
          <div class="card__head">
            <h2>Planned / One-time Expenses</h2>
            <button class="btn btn--secondary" id="addPlan">Add Event</button>
          </div>
          <p class="small">Events at specific ages (e.g., higher education, renovation). Amounts inflate from today by the item’s inflation.</p>
          <div class="table-wrap">
            <table id="planTable">
              <thead>
                <tr>
                  <th scope="col">Event</th>
                  <th class="num" scope="col">Event Age</th>
                  <th class="num" scope="col">Amount Today (₹)</th>
                  <th class="num" scope="col">Inflation</th>
                  <th scope="col">Action</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Results -->
      <div class="card section" id="results" aria-label="Results">
        <div class="card__head">
          <h2>Projection & Results</h2>
          <div class="card__tools">
            <button class="btn btn--secondary" id="auditBtn" title="Show calculation audit">Open Audit</button>
            <button class="btn btn--secondary" id="shareBtn" title="Create a shareable link">Share Plan</button>
            <button class="btn btn--primary" id="exportBtn" title="Export projection as CSV">Export CSV</button>
          </div>
        </div>
        <p class="small">Ending corpus targeted near zero at age <span id="lifeAgeEcho">85</span> (± tolerance). Click a row to audit the year’s math.</p>

        <div class="table-wrap">
          <table id="projTable" aria-label="Projection table">
            <thead>
              <tr>
                <th class="sortable" data-key="age" aria-sort="ascending" scope="col">Age</th>
                <th class="sortable num" data-key="reg" scope="col">Regular (₹)</th>
                <th class="sortable num" data-key="planned" scope="col">Planned (₹)</th>
                <th class="sortable num" data-key="total" scope="col">Total (₹)</th>
                <th class="sortable num" data-key="totalWithBuffer" scope="col">+ Buffer (₹)</th>
                <th class="sortable num" data-key="startCorpus" scope="col">Start Corpus (₹)</th>
                <th class="sortable num" data-key="ret" scope="col">Return (₹)</th>
                <th class="sortable num" data-key="endCorpus" scope="col">End Corpus (₹)</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div class="pager" id="pager"></div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer" role="contentinfo">
    <div class="wrap footer__inner">
      <div>© FreedomNumber</div>
      <div class="footer__muted">Educational tool. Please consult a qualified advisor for financial decisions.</div>
    </div>
  </footer>

  <!-- Calculation Audit Modal -->
  <div class="modal-backdrop" id="auditBackdrop" role="dialog" aria-modal="true" aria-labelledby="auditTitle">
    <div class="modal">
      <div class="modal__head">
        <h3 id="auditTitle">Calculation Audit</h3>
        <div class="modal__tools">
          <input id="auditAge" type="number" class="audit__age" aria-label="Audit age" />
          <button class="btn btn--secondary" id="auditGo">Show</button>
          <button class="btn btn--secondary" id="auditClose">Close</button>
        </div>
      </div>
      <div id="auditSummary" class="small modal__summary"></div>
      <div class="audit-grid">
        <div class="audit-block">
          <b>Regular Expenses</b>
          <div id="auditRegular" class="mono audit__list"></div>
        </div>
        <div class="audit-block">
          <b>Planned Expenses</b>
          <div id="auditPlanned" class="mono audit__list"></div>
        </div>
        <div class="audit-block">
          <b>Aggregation</b>
          <div id="auditAgg" class="mono audit__list"></div>
        </div>
        <div class="audit-block">
          <b>Formulas</b>
          <div class="mono small">
            Regular @ age A (start S, growth g): amountToday × (1+g)^(A − S)<br><br>
            Planned @ event age E (inflation i): amountToday × (1+i)^(E − currentAge)<br><br>
            total = regular + planned<br>
            totalWithBuffer = total × (1 + buffer)<br>
            retirementIncomeOffset (post-freedom) = max(0, totalWithBuffer − retirementIncome)<br><br>
            effectiveRate(age) = (return − TER), stressed −2% real for first 10 post-freedom years if enabled<br>
            return = startCorpus × effectiveRate(age)<br>
            endCorpus = startCorpus + return + contribution − retirementIncomeOffset
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
